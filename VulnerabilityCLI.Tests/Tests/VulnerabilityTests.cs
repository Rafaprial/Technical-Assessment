using System;
using System.Collections.Generic;
using System.Text.Json;
using VulnerabilityCLI;
using Xunit;

namespace VulnerabilityCLI.Tests
{
    public class VulnerabilityTests
    {
        [Fact]
        public void ValidJson_ReturnsVulnerabilityList()
        {
            string json = @"{""vulnerabilities"":[
                {""title"":""Test Vuln"",""description"":""Test Description"",""cve"":""CVE-2023-1234"",""criticality"":3}
            ]}";

            var vulnerabilities = JsonSerializer.Deserialize<VulnerabilityData>(json);

            Assert.NotNull(vulnerabilities);
            Assert.Single(vulnerabilities.Vulnerabilities);
            Assert.Equal("Test Vuln", vulnerabilities.Vulnerabilities[0].Title);
        }
    }
}
